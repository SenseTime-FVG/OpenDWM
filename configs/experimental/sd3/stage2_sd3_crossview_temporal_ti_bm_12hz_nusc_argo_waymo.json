{
    "device": "cuda",
    "ddp_backend": "nccl",
    "train_epochs": 10,
    "generator_seed": 0,
    "data_shuffle": true,
    "pipeline": {
        "_class_name": "dwm.pipelines.sd3.Sd3",
        "common_config": {
            "single_frame":false,
            "visible_frame": 3,
            "batch_frame": 6,
            "ar_input_type": "pred",
            "distribution_framework": "fsdp",
            "ddp_wrapper_settings": {
                "auto_wrap_policy": {
                    "_class_name": "torch.distributed.fsdp.wrap.ModuleWrapPolicy",
                    "module_classes": [
                        {
                            "_class_name": "get_class",
                            "class_name": "diffusers.models.attention.JointTransformerBlock"
                        },
                        {
                            "_class_name": "get_class",
                            "class_name": "dwm.models.crossview_temporal_dit.VTSelfAttentionBlock"
                        }
                    ]
                },
                "mixed_precision": {
                    "_class_name": "torch.distributed.fsdp.MixedPrecision",
                    "param_dtype": {
                        "_class_name": "get_class",
                        "class_name": "torch.float16"
                    }
                },
                "sharding_strategy":{
                    "_class_name": "torch.distributed.fsdp.ShardingStrategy",
                    "value": 1
                },
                "use_orig_params": true
            },
            "disable_crossview": false,
            "disable_temporal": false,
            "enable_T5": true,
            "added_camera_ids": "raymap",
            "condition_on_all_frames": true
        },
        "training_config": {
            "use_amp": true,
            "latent_sample_method": "sample",
            "text_prompt_condition_ratio": 0.8,
            "3dbox_condition_ratio": 0.8,
            "hdmap_condition_ratio": 0.8,
            "drop_temporal_ratio": 0.2,
            "unreference_condition_ratio": 0.5,
            "gradient_accumulation_steps": 1,
            "optimizer_name": "torch.optim.AdamW",
            "optimizer_arguments": {
                "lr": 8e-5
            },
            "optimization_scheduler": {
                "name": "constant"
            },
            "enable_grad_clip": true,
            "enable_grad_scaler": true,
            "freezing_pattern": "^(transformer_blocks|time_text_embed|context_embeder|pos_embed|norm_out|proj_out)"
        },
        "inference_config": {
            "guidance_scale": 3,
            "inference_steps": 50,
            "preview_image_size": [
                448,
                256
            ],
            "fid_evaluation_maximum_sample_count": 10000
        },
        "pretrained_model_name_or_path": "/mnt/storage/user/wuzehuan/Downloads/models/stable-diffusion-3-medium-diffusers",
        "DiT_checkpoint_path": "/mnt/storage/user/chenrui4/Tasks/stage1_sd3_temporal_ti_bm_opendv/checkpoints/32000.pth",
        "DiT": 
        {
            "_class_name": "dwm.models.crossview_temporal_dit.DiTCrossviewTemporalConditionModel",
            "attention_head_dim": 64,
            "caption_projection_dim": 1536,
            "in_channels": 16,
            "joint_attention_dim": 4096,
            "num_attention_heads": 24,
            "num_layers": 24,
            "out_channels": 16,
            "patch_size": 2,
            "pooled_projection_dim": 2048,
            "pos_embed_max_size": 192,
            "sample_size": 128,
            
            "enable_crossview": true,
            "crossview_attention_type": "full",
            "crossview_block_layers": [1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23],
            "crossview_gradient_checkpointing": true,

            "enable_temporal": true,
            "temporal_attention_type": "full",
            "temporal_block_layers": [1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23],
            "temporal_gradient_checkpointing": true,

            "mixer_type": "mixer", 

            "condition_image_adapter_config": {
                "in_channels": 6,
                "channels": [
                    1536,
                    1536,
                    1536,
                    1536,
                    1536,
                    1536
                ],
                "is_downblocks": [
                    true,
                    false,
                    false,
                    false,
                    false,
                    false
                ],
                "num_res_blocks": 2,
                "downscale_factor": 8,
                "use_zero_convs": true,
                "gradient_checkpointing": true
            }
        },
        "checkpointing": true
    },
    "training_dataset": {
        "_class_name": "dwm.datasets.common.DatasetAdapter",
        "base_dataset": {
            "_class_name": "torch.utils.data.ConcatDataset",
            "datasets": [
                {
                    "_class_name": "dwm.datasets.nuscenes.MotionDataset",
                    "fs": {
                        "_class_name": "dwm.fs.czip.CombinedZipFileSystem",
                        "fs": {
                            "_class_name": "dwm.fs.dirfs.DirFileSystem",
                            "path": "/cache/aoss-v2.st-sh-01.sensecoreapi-oss.cn/users/wuzehuan",
                            "fs": {
                                "_class_name": "fsspec.implementations.local.LocalFileSystem"
                            }
                        },
                        "paths": [
                            "workspaces/worldmodels/data/v1.0-trainval_12hz_meta.zip",
                            "data/nuscenes/v1.0-trainval01_blobs.zip",
                            "data/nuscenes/v1.0-trainval02_blobs.zip",
                            "data/nuscenes/v1.0-trainval03_blobs.zip",
                            "data/nuscenes/v1.0-trainval04_blobs.zip",
                            "data/nuscenes/v1.0-trainval05_blobs.zip",
                            "data/nuscenes/v1.0-trainval06_blobs.zip",
                            "data/nuscenes/v1.0-trainval07_blobs.zip",
                            "data/nuscenes/v1.0-trainval08_blobs.zip",
                            "data/nuscenes/v1.0-trainval09_blobs.zip",
                            "data/nuscenes/v1.0-trainval10_blobs.zip",
                            "data/nuscenes/nuScenes-map-expansion-v1.3.zip"
                        ],
                        "enable_cached_info": true
                    },
                    "dataset_name": "v1.0-trainval_12hz",
                    "split": "train",
                    "sequence_length": 6,
                    "fps_stride_tuples": [
                        [
                            10,
                            1
                        ]
                    ],
                    "sensor_channels": [
                        "LIDAR_TOP",
                        "CAM_FRONT_LEFT",
                        "CAM_FRONT",
                        "CAM_FRONT_RIGHT",
                        "CAM_BACK_RIGHT",
                        "CAM_BACK",
                        "CAM_BACK_LEFT"
                    ],
                    "keyframe_only": true,
                    "enable_camera_transforms": true,
                    "enable_ego_transforms": true,
                    "_3dbox_image_settings": {
                        "pen_width": 8,
                        "color_table": {
                            "vehicle.car": [
                                0,
                                0,
                                255
                            ],
                            "vehicle.bus": [
                                128,
                                0,
                                255
                            ],
                            "vehicle.truck": [
                                255,
                                255,
                                0
                            ],
                            "vehicle.construction": [
                                128,
                                128,
                                255
                            ],
                            "vehicle.emergency": [
                                255,
                                128,
                                128
                            ],
                            "vehicle.trailer": [
                                255,
                                255,
                                255
                            ],
                            "vehicle.bicycle": [
                                128,
                                255,
                                0
                            ],
                            "vehicle.motorcycle": [
                                0,
                                255,
                                128
                            ],
                            "human.pedestrian": [
                                255,
                                0,
                                0
                            ],
                            "movable_object.barrier": [
                                64,
                                64,
                                64
                            ],
                            "movable_object.trafficcone": [
                                128,
                                128,
                                0
                            ]
                        },
                        "edge_indices": [
                            [
                                0,
                                1
                            ],
                            [
                                0,
                                2
                            ],
                            [
                                1,
                                3
                            ],
                            [
                                2,
                                3
                            ],
                            [
                                0,
                                4
                            ],
                            [
                                1,
                                5
                            ],
                            [
                                2,
                                6
                            ],
                            [
                                3,
                                7
                            ],
                            [
                                4,
                                5
                            ],
                            [
                                4,
                                6
                            ],
                            [
                                5,
                                7
                            ],
                            [
                                6,
                                7
                            ],
                            [
                                6,
                                3
                            ],
                            [
                                6,
                                5
                            ]
                        ]
                    },
                    "hdmap_image_settings": {
                        "path": "/mnt/storage/user/chenrui4/workspaces/worldmodels/data/nuScenes-map-expansion-v1.3_new.json"
                    },
                    "image_description_settings": {
                        "path": "/cache/aoss-v2.st-sh-01.sensecoreapi-oss.cn/users/wuzehuan/workspaces/worldmodels/data/nuscenes_v1.0-trainval_caption_v2_train.json",
                        "time_list_dict_path": "/cache/aoss-v2.st-sh-01.sensecoreapi-oss.cn/users/wuzehuan/workspaces/worldmodels/data/nuscenes_v1.0-trainval_caption_v2_times_train.json",
                        "align_keys": [
                            "time",
                            "weather"
                        ],
                        "reorder_keys": true,
                        "drop_rates": {
                            "environment": 0.04,
                            "objects": 0.08,
                            "image_description": 0.16
                        }
                    }
                },
                {
                    "_class_name": "dwm.datasets.waymo.MotionDataset",
                    "fs": {
                        "_class_name": "dwm.fs.dirfs.DirFileSystem",
                        "path": "/cache/aoss-v2.st-sh-01.sensecoreapi-oss.cn/users/wuzehuan/data/waymo/waymo_open_dataset_v_1_4_3/training",
                        "fs": {
                            "_class_name": "fsspec.implementations.local.LocalFileSystem"
                        }
                    },
                    "info_dict_path": "/cache/aoss-v2.st-sh-01.sensecoreapi-oss.cn/users/wuzehuan/data/waymo/waymo_open_dataset_v_1_4_3/waymo_info_dict_v1_4_3_training.json",
                    "sequence_length": 6,
                    "fps_stride_tuples": [
                        [
                            10,
                            1
                        ]
                    ],
                    "sensor_channels": [
                        "LIDAR_TOP",
                        "CAM_SIDE_LEFT",
                        "CAM_FRONT_LEFT",
                        "CAM_FRONT",
                        "CAM_FRONT_RIGHT",
                        "CAM_SIDE_RIGHT",
                        "CAM_FRONT"
                    ],
                    "enable_camera_transforms": true,
                    "enable_ego_transforms": true,
                    "_3dbox_image_settings": {
                        "pen_width": 8, 
                        "color_table": {
                            "PEDESTRIAN": [
                                255,
                                0,
                                0
                            ],
                            "CYCLIST": [
                                0,
                                255,
                                0
                            ],
                            "VEHICLE": [
                                0,
                                0,
                                255
                            ]
                        },
                        "edge_indices": [
                            [
                                0,
                                1
                            ],
                            [
                                0,
                                2
                            ],
                            [
                                1,
                                3
                            ],
                            [
                                2,
                                3
                            ],
                            [
                                0,
                                4
                            ],
                            [
                                1,
                                5
                            ],
                            [
                                2,
                                6
                            ],
                            [
                                3,
                                7
                            ],
                            [
                                4,
                                5
                            ],
                            [
                                4,
                                6
                            ],
                            [
                                5,
                                7
                            ],
                            [
                                6,
                                7
                            ],
                            [
                                6,
                                3
                            ],
                            [
                                6,
                                5
                            ]
                        ]
                    },
                    "hdmap_image_settings": {
                        "color_table": {
                            "crosswalk": [
                                255,
                                0,
                                0
                            ],
                            "road_line": [
                                0,
                                255,
                                0
                            ],
                            "road_edge": [
                                0,
                                0,
                                255
                            ]
                        }
                    },
                    "image_description_settings": {
                        "fs": {
                            "_class_name": "dwm.fs.czip.CombinedZipFileSystem",
                            "fs": {
                                "_class_name": "dwm.fs.dirfs.DirFileSystem",
                                "path": "/cache/aoss-v2.st-sh-01.sensecoreapi-oss.cn/users/wuzehuan",
                                "fs": {
                                    "_class_name": "fsspec.implementations.local.LocalFileSystem"
                                }
                            },
                            "paths": [
                                "workspaces/worldmodels/data/waymo_caption_train.zip"
                            ]
                        },
                        "align_keys": [
                            "time",
                            "weather"
                        ],
                        "reorder_keys": true,
                        "drop_rates": {
                            "environment": 0.04,
                            "objects": 0.08,
                            "image_description": 0.16
                        }
                    }
                },
                {
                    "_class_name": "dwm.datasets.argoverse.MotionDataset",
                    "fs": {
                        "_class_name": "dwm.fs.czip.CombinedZipFileSystem",
                        "fs": {
                            "_class_name": "dwm.fs.dirfs.DirFileSystem",
                            "path": "/cache/aoss-v2.st-sh-01.sensecoreapi-oss.cn/users/wuzehuan",
                            "fs": {
                                "_class_name": "fsspec.implementations.local.LocalFileSystem"
                            }
                        },
                        "paths": [
                            "data/argoverse/av2/sensor/train-000.zip",
                            "data/argoverse/av2/sensor/train-001.zip",
                            "data/argoverse/av2/sensor/train-002.zip",
                            "data/argoverse/av2/sensor/train-003.zip",
                            "data/argoverse/av2/sensor/train-004.zip",
                            "data/argoverse/av2/sensor/train-005.zip",
                            "data/argoverse/av2/sensor/train-006.zip",
                            "data/argoverse/av2/sensor/train-007.zip",
                            "data/argoverse/av2/sensor/train-008.zip",
                            "data/argoverse/av2/sensor/train-009.zip",
                            "data/argoverse/av2/sensor/train-010.zip",
                            "data/argoverse/av2/sensor/train-011.zip",
                            "data/argoverse/av2/sensor/train-012.zip",
                            "data/argoverse/av2/sensor/train-013.zip",
                            "workspaces/worldmodels/data/av2_sensor_caption_train.zip"
                        ],
                        "enable_cached_info": true
                    },
                    "sequence_length": 6,
                    "fps_stride_tuples": [
                        [
                            10,
                            1
                        ]
                    ],
                    "sensor_channels": [
                        "lidar",
                        "cameras/ring_front_left",
                        "cameras/ring_front_right",
                        "cameras/ring_side_right",
                        "cameras/ring_rear_right",
                        "cameras/ring_rear_left",
                        "cameras/ring_side_left"
                    ],
                    "enable_camera_transforms": true,
                    "enable_ego_transforms": true,
                    "_3dbox_image_settings": {
                        "pen_width": 10,
                        "color_table": {
                            "BICYCLIST": [
                                255,
                                0,
                                0
                            ],
                            "MOTORCYCLIST": [
                                255,
                                0,
                                0
                            ],
                            "PEDESTRIAN": [
                                255,
                                0,
                                0
                            ],
                            "BICYCLE": [
                                128,
                                255,
                                0
                            ],
                            "MOTORCYCLE": [
                                0,
                                255,
                                128
                            ],
                            "BOX_TRUCK": [
                                255,
                                255,
                                0
                            ],
                            "BUS": [
                                128,
                                0,
                                255
                            ],
                            "LARGE_VEHICLE": [
                                0,
                                0,
                                255
                            ],
                            "REGULAR_VEHICLE": [
                                0,
                                0,
                                255
                            ],
                            "SCHOOL_BUS": [
                                128,
                                0,
                                255
                            ],
                            "TRUCK": [
                                255,
                                255,
                                0
                            ],
                            "TRUCK_CAB": [
                                255,
                                255,
                                0
                            ],
                            "VEHICULAR_TRAILER": [
                                255,
                                255,
                                255
                            ]
                        },
                        "edge_indices": [
                            [
                                0,
                                1
                            ],
                            [
                                0,
                                2
                            ],
                            [
                                1,
                                3
                            ],
                            [
                                2,
                                3
                            ],
                            [
                                0,
                                4
                            ],
                            [
                                1,
                                5
                            ],
                            [
                                2,
                                6
                            ],
                            [
                                3,
                                7
                            ],
                            [
                                4,
                                5
                            ],
                            [
                                4,
                                6
                            ],
                            [
                                5,
                                7
                            ],
                            [
                                6,
                                7
                            ],
                            [
                                6,
                                3
                            ],
                            [
                                6,
                                5
                            ]
                        ]
                    },
                    "hdmap_image_settings": {
                        "color_table": {
                            "pedestrian_crossings": [
                                255,
                                0,
                                0
                            ],
                            "lane_segments": [
                                0,
                                255,
                                0
                            ],
                            "drivable_areas": [
                                0,
                                0,
                                255
                            ]
                        }
                    },
                    "image_description_settings": {
                        "align_keys": [
                            "time",
                            "weather"
                        ],
                        "reorder_keys": true,
                        "drop_rates": {
                            "environment": 0.04,
                            "objects": 0.08,
                            "image_description": 0.16
                        }
                    }
                }
            ]
        },
        "transform_list": [
            {
                "old_key": "images",
                "new_key": "vae_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                256,
                                448
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "3dbox_images",
                "new_key": "3dbox_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                256,
                                448
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "hdmap_images",
                "new_key": "hdmap_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                256,
                                448
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "image_description",
                "new_key": "clip_text",
                "transform": {
                    "_class_name": "dwm.datasets.common.Copy"
                },
                "stack": false
            }
        ],
        "pop_list": [
            "images",
            "lidar_points",
            "image_description"
        ]
    },
    "validation_dataset": {
        "_class_name": "dwm.datasets.common.DatasetAdapter",
        "base_dataset": {
            "_class_name": "torch.utils.data.ConcatDataset",
            "datasets": [
                {
                    "_class_name": "dwm.datasets.nuscenes.MotionDataset",
                    "fs": {
                        "_class_name": "dwm.fs.czip.CombinedZipFileSystem",
                        "fs": {
                            "_class_name": "dwm.fs.dirfs.DirFileSystem",
                            "path": "/cache/aoss-v2.st-sh-01.sensecoreapi-oss.cn/users/wuzehuan",
                            "fs": {
                                "_class_name": "fsspec.implementations.local.LocalFileSystem"
                            }
                        },
                        "paths": [
                            "data/nuscenes/v1.0-trainval_meta.zip",
                            "data/nuscenes/v1.0-trainval01_blobs.zip",
                            "data/nuscenes/v1.0-trainval02_blobs.zip",
                            "data/nuscenes/v1.0-trainval03_blobs.zip",
                            "data/nuscenes/v1.0-trainval04_blobs.zip",
                            "data/nuscenes/v1.0-trainval05_blobs.zip",
                            "data/nuscenes/v1.0-trainval06_blobs.zip",
                            "data/nuscenes/v1.0-trainval07_blobs.zip",
                            "data/nuscenes/v1.0-trainval08_blobs.zip",
                            "data/nuscenes/v1.0-trainval09_blobs.zip",
                            "data/nuscenes/v1.0-trainval10_blobs.zip",
                            "data/nuscenes/nuScenes-map-expansion-v1.3.zip"
                        ],
                        "enable_cached_info": true
                    },
                    "dataset_name": "v1.0-trainval",
                    "split": "val",
                    "sequence_length": 21,
                    "fps_stride_tuples": [
                        [
                            10,
                            6
                        ]
                    ],
                    "sensor_channels": [
                        "LIDAR_TOP",
                        "CAM_FRONT_LEFT",
                        "CAM_FRONT",
                        "CAM_FRONT_RIGHT",
                        "CAM_BACK_RIGHT",
                        "CAM_BACK",
                        "CAM_BACK_LEFT"
                    ],
                    "keyframe_only": true,
                    "enable_camera_transforms": true,
                    "enable_ego_transforms": true,
                    "_3dbox_image_settings": {
                        "pen_width": 8,
                        "color_table": {
                            "vehicle.car": [
                                0,
                                0,
                                255
                            ],
                            "vehicle.bus": [
                                128,
                                0,
                                255
                            ],
                            "vehicle.truck": [
                                255,
                                255,
                                0
                            ],
                            "vehicle.construction": [
                                128,
                                128,
                                255
                            ],
                            "vehicle.emergency": [
                                255,
                                128,
                                128
                            ],
                            "vehicle.trailer": [
                                255,
                                255,
                                255
                            ],
                            "vehicle.bicycle": [
                                128,
                                255,
                                0
                            ],
                            "vehicle.motorcycle": [
                                0,
                                255,
                                128
                            ],
                            "human.pedestrian": [
                                255,
                                0,
                                0
                            ],
                            "movable_object.barrier": [
                                64,
                                64,
                                64
                            ],
                            "movable_object.trafficcone": [
                                128,
                                128,
                                0
                            ]
                        },
                        "edge_indices": [
                            [
                                0,
                                1
                            ],
                            [
                                0,
                                2
                            ],
                            [
                                1,
                                3
                            ],
                            [
                                2,
                                3
                            ],
                            [
                                0,
                                4
                            ],
                            [
                                1,
                                5
                            ],
                            [
                                2,
                                6
                            ],
                            [
                                3,
                                7
                            ],
                            [
                                4,
                                5
                            ],
                            [
                                4,
                                6
                            ],
                            [
                                5,
                                7
                            ],
                            [
                                6,
                                7
                            ],
                            [
                                6,
                                3
                            ],
                            [
                                6,
                                5
                            ]
                        ]
                    },
                    "hdmap_image_settings": {
                        "path": "/mnt/storage/user/chenrui4/workspaces/worldmodels/data/nuScenes-map-expansion-v1.3_new.json"
                    },
                    "image_description_settings": {
                        "path": "/cache/aoss-v2.st-sh-01.sensecoreapi-oss.cn/users/wuzehuan/workspaces/worldmodels/data/nuscenes_v1.0-trainval_caption_v2_val.json",
                        "time_list_dict_path": "/cache/aoss-v2.st-sh-01.sensecoreapi-oss.cn/users/wuzehuan/workspaces/worldmodels/data/nuscenes_v1.0-trainval_caption_v2_times_val.json",
                        "align_keys": [
                            "time",
                            "weather"
                        ]
                    }
                },
                {
                    "_class_name": "dwm.datasets.waymo.MotionDataset",
                    "fs": {
                        "_class_name": "dwm.fs.dirfs.DirFileSystem",
                        "path": "/cache/aoss-v2.st-sh-01.sensecoreapi-oss.cn/users/wuzehuan/data/waymo/waymo_open_dataset_v_1_4_3/validation",
                        "fs": {
                            "_class_name": "fsspec.implementations.local.LocalFileSystem"
                        }
                    },
                    "info_dict_path": "/cache/aoss-v2.st-sh-01.sensecoreapi-oss.cn/users/wuzehuan/data/waymo/waymo_open_dataset_v_1_4_3/waymo_info_dict_v1_4_3_validation.json",
                    "sequence_length": 21,
                    "fps_stride_tuples": [
                        [
                            10,
                            6
                        ]
                    ],
                    "sensor_channels": [
                        "LIDAR_TOP",
                        "CAM_SIDE_LEFT",
                        "CAM_FRONT_LEFT",
                        "CAM_FRONT",
                        "CAM_FRONT_RIGHT",
                        "CAM_SIDE_RIGHT",
                        "CAM_FRONT"
                    ],
                    "enable_camera_transforms": true,
                    "enable_ego_transforms": true,
                    "_3dbox_image_settings": {
                        "pen_width": 8,
                        "color_table": {
                            "PEDESTRIAN": [
                                255,
                                0,
                                0
                            ],
                            "CYCLIST": [
                                0,
                                255,
                                0
                            ],
                            "VEHICLE": [
                                0,
                                0,
                                255
                            ]
                        },
                        "edge_indices": [
                            [
                                0,
                                1
                            ],
                            [
                                0,
                                2
                            ],
                            [
                                1,
                                3
                            ],
                            [
                                2,
                                3
                            ],
                            [
                                0,
                                4
                            ],
                            [
                                1,
                                5
                            ],
                            [
                                2,
                                6
                            ],
                            [
                                3,
                                7
                            ],
                            [
                                4,
                                5
                            ],
                            [
                                4,
                                6
                            ],
                            [
                                5,
                                7
                            ],
                            [
                                6,
                                7
                            ],
                            [
                                6,
                                3
                            ],
                            [
                                6,
                                5
                            ]
                        ]
                    },
                    "hdmap_image_settings": {
                        "color_table": {
                            "crosswalk": [
                                255,
                                0,
                                0
                            ],
                            "road_line": [
                                0,
                                255,
                                0
                            ],
                            "road_edge": [
                                0,
                                0,
                                255
                            ]
                        }
                    },
                    "image_description_settings": {
                        "fs": {
                            "_class_name": "dwm.fs.czip.CombinedZipFileSystem",
                            "fs": {
                                "_class_name": "dwm.fs.dirfs.DirFileSystem",
                                "path": "/cache/aoss-v2.st-sh-01.sensecoreapi-oss.cn/users/wuzehuan",
                                "fs": {
                                    "_class_name": "fsspec.implementations.local.LocalFileSystem"
                                }
                            },
                            "paths": [
                                "workspaces/worldmodels/data/waymo_caption_val.zip"
                            ]
                        },
                        "align_keys": [
                            "time",
                            "weather"
                        ]
                    }
                },
                {
                    "_class_name": "dwm.datasets.argoverse.MotionDataset",
                    "fs": {
                        "_class_name": "dwm.fs.czip.CombinedZipFileSystem",
                        "fs": {
                            "_class_name": "dwm.fs.dirfs.DirFileSystem",
                            "path": "/cache/aoss-v2.st-sh-01.sensecoreapi-oss.cn/users/wuzehuan",
                            "fs": {
                                "_class_name": "fsspec.implementations.local.LocalFileSystem"
                            }
                        },
                        "paths": [
                            "data/argoverse/av2/sensor/val-000.zip",
                            "data/argoverse/av2/sensor/val-001.zip",
                            "data/argoverse/av2/sensor/val-002.zip",
                            "workspaces/worldmodels/data/av2_sensor_caption_val.zip"
                        ]
                    },
                    "sequence_length": 21,
                    "fps_stride_tuples": [
                        [
                            10,
                            6
                        ]
                    ],
                    "sensor_channels": [
                        "lidar",
                        "cameras/ring_front_left",
                        "cameras/ring_front_right",
                        "cameras/ring_side_right",
                        "cameras/ring_rear_right",
                        "cameras/ring_rear_left",
                        "cameras/ring_side_left"
                    ],
                    "enable_camera_transforms": true,
                    "enable_ego_transforms": true,
                    "_3dbox_image_settings": {
                        "pen_width": 10,
                        "color_table": {
                            "BICYCLIST": [
                                255,
                                0,
                                0
                            ],
                            "MOTORCYCLIST": [
                                255,
                                0,
                                0
                            ],
                            "PEDESTRIAN": [
                                255,
                                0,
                                0
                            ],
                            "BICYCLE": [
                                128,
                                255,
                                0
                            ],
                            "MOTORCYCLE": [
                                0,
                                255,
                                128
                            ],
                            "BOX_TRUCK": [
                                255,
                                255,
                                0
                            ],
                            "BUS": [
                                128,
                                0,
                                255
                            ],
                            "LARGE_VEHICLE": [
                                0,
                                0,
                                255
                            ],
                            "REGULAR_VEHICLE": [
                                0,
                                0,
                                255
                            ],
                            "SCHOOL_BUS": [
                                128,
                                0,
                                255
                            ],
                            "TRUCK": [
                                255,
                                255,
                                0
                            ],
                            "TRUCK_CAB": [
                                255,
                                255,
                                0
                            ],
                            "VEHICULAR_TRAILER": [
                                255,
                                255,
                                255
                            ]
                        },
                        "edge_indices": [
                            [
                                0,
                                1
                            ],
                            [
                                0,
                                2
                            ],
                            [
                                1,
                                3
                            ],
                            [
                                2,
                                3
                            ],
                            [
                                0,
                                4
                            ],
                            [
                                1,
                                5
                            ],
                            [
                                2,
                                6
                            ],
                            [
                                3,
                                7
                            ],
                            [
                                4,
                                5
                            ],
                            [
                                4,
                                6
                            ],
                            [
                                5,
                                7
                            ],
                            [
                                6,
                                7
                            ],
                            [
                                6,
                                3
                            ],
                            [
                                6,
                                5
                            ]
                        ]
                    },
                    "hdmap_image_settings": {
                        "color_table": {
                            "pedestrian_crossings": [
                                255,
                                0,
                                0
                            ],
                            "lane_segments": [
                                0,
                                255,
                                0
                            ],
                            "drivable_areas": [
                                0,
                                0,
                                255
                            ]
                        }
                    },
                    "image_description_settings": {
                        "align_keys": [
                            "time",
                            "weather"
                        ]
                    }
                }
            ]
        },
        "transform_list": [
            {
                "old_key": "images",
                "new_key": "vae_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                256,
                                448
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "3dbox_images",
                "new_key": "3dbox_images_denorm",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                256,
                                448
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "3dbox_images",
                "new_key": "3dbox_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                256,
                                448
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "hdmap_images",
                "new_key": "hdmap_images_denorm",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                256,
                                448
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "hdmap_images",
                "new_key": "hdmap_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                256,
                                448
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "image_description",
                "new_key": "clip_text",
                "transform": {
                    "_class_name": "dwm.datasets.common.Copy"
                },
                "stack": false
            }
        ],
        "pop_list": [
            "images",
            "lidar_points",
            "image_description"
        ]
    },
    "training_dataloader": {
        "batch_size": 1,
        "num_workers": 3,
        "prefetch_factor": 3,
        "collate_fn": {
            "_class_name": "dwm.datasets.common.CollateFnIgnoring",
            "keys": [
                "clip_text"
            ]
        },
        "persistent_workers": true
    },
    "validation_dataloader": {
        "batch_size": 1,
        "num_workers": 2,
        "prefetch_factor": 3,
        "collate_fn": {
            "_class_name": "dwm.datasets.common.CollateFnIgnoring",
            "keys": [
                "clip_text"
            ]
        },
        "persistent_workers": true
    },
    "preview_dataloader": {
        "batch_size": 1,
        "num_workers": 1,
        "shuffle": true,
        "drop_last": true,
        "collate_fn": {
            "_class_name": "dwm.datasets.common.CollateFnIgnoring",
            "keys": [
                "clip_text"
            ]
        },
        "persistent_workers": true
    }
}