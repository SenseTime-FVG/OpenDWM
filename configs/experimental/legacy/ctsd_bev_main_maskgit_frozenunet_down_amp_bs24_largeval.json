{
    "device": "cuda",
    "ddp_backend": "nccl",
    "generator_seed": 0,
    "text_prompt_condition_ratio": 0.8,
    "3dbox_condition_ratio": 0.8,
    "hdmap_condition_ratio": 0.8,
    "timestep": 100,
    "pipeline": {
        "_class_name": "dwm.pipelines.lidar_maskgit_cond_addUNet.MaskGIT",
        "common_config": {
            "disable_crossview": false,
            "disable_temporal": true
        },
        "training_config": {
            "latent_sample_method": "sample",
            "text_prompt_condition_ratio": 0.8,
            "3dbox_condition_ratio": 0.8,
            "hdmap_condition_ratio": 0.8,
            "gradient_accumulation_steps": 1,
            "optimizer_name": "torch.optim.AdamW",
            "optimizer_arguments": {
                "lr": 1e-5
            },
            "optimization_scheduler": {
                "name": "constant"
            },
            "use_amp": true,
            "frozen_unet_down": true
        },
        "inference_config": {
            "guidance_scale": 3,
            "inference_steps": 50,
            "preview_image_size": [
                384,
                216
            ],
            "fid_evaluation_maximum_sample_count": 10000
        },
        "layout_encoder_config": {
            "model_name": "convnextv2_base.fcmae",
            "pretrained": true,
            "num_classes": 0
        },
        "pretrained_model_name_or_path": "/mnt/storage/user/wuzehuan/Downloads/models/stable-diffusion-2-1",
        "unet_checkpoint_path": "/mnt/storage/user/wuzehuan/Documents/WorldModels/Models/dwm/ctsd_crossview_20000.safetensors",
        "unet_load_state_args": {
            "strict": true
        },
        "unet": {
            "_class_name": "dwm.models.unet_crossview_temporal_condition_model.UNetCrossviewTemporalConditionModel",
            "addition_time_embed_dim": 256,
            "block_out_channels": [
                320,
                640,
                1280,
                1280
            ],
            "cross_attention_dim": 1024,
            "down_block_types": [
                "CrossAttnDownBlockCrossviewTemporal",
                "CrossAttnDownBlockCrossviewTemporal",
                "CrossAttnDownBlockCrossviewTemporal",
                "DownBlockCrossviewTemporal"
            ],
            "in_channels": 4,
            "layers_per_block": 2,
            "num_attention_heads": [
                5,
                10,
                20,
                20
            ],
            "out_channels": 4,
            "projection_class_embeddings_input_dim": 768,
            "sample_size": 96,
            "transformer_layers_per_block": 1,
            "up_block_types": [
                "UpBlockCrossviewTemporal",
                "CrossAttnUpBlockCrossviewTemporal",
                "CrossAttnUpBlockCrossviewTemporal",
                "CrossAttnUpBlockCrossviewTemporal"
            ],
            "enable_crossview": true,
            "enable_temporal": false
        },
        "use_unet_down_feat": true,
        "conditional": true,
        "freeze_bevformer": false,
        "unload_encoder": false,
        "partial_frozen_bev": false,
        "bi_directional_Transformer_checkpoint_path": "/mnt/storage/user/wangxiaodong/DWM_work_dir/ctsd_bev_main_maskgit_frozenunet_down_amp_bs32_1e-4_run2/checkpoints/30000.pth",
        "vq_point_cloud_checkpoint_path": "/mnt/storage/user/wuzehuan/Documents/WorldModels/Models/dwm-lidar/codebook_epoch_100.pth",
        "vq_point_cloud": {
            "_class_name": "dwm.models.vq_point_cloud.VQPointCloud",
            "voxelizer": {
                "_class_name": "dwm.models.voxelizer.Voxelizer",
                "x_min": -50.0,
                "x_max": 50.0,
                "y_min": -50.0,
                "y_max": 50.0,
                "z_min": -5.0,
                "z_max": 3.0,
                "step": 0.15625,
                "z_step": 0.125
            },
            "vector_quantizer": {
                "_class_name": "dwm.models.vq_point_cloud.VectorQuantizer",
                "n_e": 2048,
                "e_dim": 1024,
                "beta": 0.25,
                "cosine_similarity": false
            },
            "lidar_encoder": {
                "_class_name": "dwm.models.vq_point_cloud.VQEncoder",
                "img_size": 640,
                "codebook_dim": 1024,
                "in_chans": 64,
                "embed_dim": 512,
                "num_heads": 8
            },
            "lidar_decoder": {
                "_class_name": "dwm.models.vq_point_cloud.VQDecoder",
                "img_size": [
                    640,
                    640
                ],
                "num_patches": 6400,
                "codebook_dim": 1024,
                "bias_init": -5,
                "in_chans": 64,
                "embed_dim": 512,
                "num_heads": 8
            }
        },
        "bi_directional_Transformer":{
            "_class_name": "dwm.models.transformer.BidirectionalTransformer",
            "n_e": 2048,
            "e_dim": 1024,
            "img_size": 80,
            "hidden_dim": 512,
            "depth": 24,
            "num_heads": 16,
            "use_checkpoint": true,
            "cross_attend": true,
            "add_cross_proj": true,
            "cross_proj_dim": 4608
        },
        "bevformer":{
            "_class_name": "dwm.models.bevformer.BEVFormerHead",
            "dim": 256,
            "num_levels": 4,
            "bev_h": 200,
            "bev_w": 200,
            "num_query": 900,
            "type": "unet-down"
        },
        "bevformer_path": "/mnt/storage/user/wangxiaodong/Models/bevformer_r101_dcn_24ep.pth"
    },
    "training_dataset": {
        "_class_name": "dwm.datasets.common.DatasetAdapter",
        "base_dataset": {
            "_class_name": "dwm.datasets.nuscenes.MotionDataset",
            "reader": {
                "_class_name": "dwm.common.ChainedReaders",
                "reader_list": [
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-trainval_meta.zip"
                        }
                    },
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-trainval01_blobs.zip"
                        }
                    },
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-trainval02_blobs.zip"
                        }
                    },
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-trainval03_blobs.zip"
                        }
                    },
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-trainval04_blobs.zip"
                        }
                    },
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-trainval05_blobs.zip"
                        }
                    },
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-trainval06_blobs.zip"
                        }
                    },
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-trainval07_blobs.zip"
                        }
                    },
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-trainval08_blobs.zip"
                        }
                    },
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-trainval09_blobs.zip"
                        }
                    },
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-trainval10_blobs.zip"
                        }
                    },
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/nuScenes-map-expansion-v1.3.zip"
                        }
                    }
                ]
            },
            "dataset_name": "v1.0-trainval",
            "sequence_length": 1,
            "fps_stride_tuples": [
                [
                    0,
                    1
                ]
            ],
            "split": "train",
            "sensor_channels": [
                "LIDAR_TOP",
                "CAM_BACK_RIGHT",
                "CAM_BACK",
                "CAM_BACK_LEFT",
                "CAM_FRONT_LEFT",
                "CAM_FRONT",
                "CAM_FRONT_RIGHT"
            ],
            "_3dbox_bev_settings": {
                "bev_from_ego_transform":
                [
                    [6.4, 0, 0, 314],
                    [0, -6.4, 0, 320],
                    [0, 0, -6.4, 0],
                    [0, 0, 0, 1]
                ],
                "fill_box": true
            },
            "hdmap_bev_settings": {
                "bev_from_ego_transform":
                [
                    [6.4, 0, 0, 314],
                    [0, -6.4, 0, 320],
                    [0, 0, -6.4, 0],
                    [0, 0, 0, 1]
                ]
            },
            "keyframe_only": true,
            "enable_scene_description": true,
            "_3dbox_image_settings": {},
            "hdmap_image_settings": {},
            "enable_camera_transforms": true,
            "is_multimodal": true,
            "enable_ego_transforms": true,
            "can_bus_extension": {
                "_class_name": "dwm.datasets.nuscenes.CanBusExtension",
                "reader": {
                    "_class_name": "dwm.common.StatelessZipFile",
                    "lazy_file": {
                        "_class_name": "dwm.common.LazyFile",
                        "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-can_bus.zip"
                    }
                }
            }
        },
        "transform_list": [
            {
                "old_key": "images",
                "new_key": "vae_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                216,
                                384
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "images",
                "new_key": "bev_images_denorm",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                900,
                                1600
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "images",
                "new_key": "bev_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                216,
                                384
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        },
                        {
                            "_class_name": "torchvision.transforms.Normalize",
                            "mean": [
                                0,
                                0,
                                0
                            ],
                            "std": [
                                0.00392157,
                                0.00392157,
                                0.00392157
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.Normalize",
                            "mean": [
                                123.675,
                                116.280,
                                103.530
                            ],
                            "std": [
                                1.0,
                                1.0,
                                1.0
                            ]
                        }
                    ]
                }
            },
            {
                "old_key": "3dbox_bev_images",
                "new_key": "3dbox_bev_images_denorm",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                640,
                                640
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "3dbox_bev_images",
                "new_key": "3dbox_bev_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                640,
                                640
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        },
                        {
                            "_class_name": "torchvision.transforms.Normalize",
                            "mean": [
                                0.485,
                                0.456,
                                0.406
                            ],
                            "std": [
                                0.229,
                                0.224,
                                0.225
                            ]
                        }
                    ]
                }
            },
            {
                "old_key": "hdmap_bev_images",
                "new_key": "hdmap_bev_images_denorm",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                640,
                                640
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "hdmap_bev_images",
                "new_key": "hdmap_bev_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                640,
                                640
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        },
                        {
                            "_class_name": "torchvision.transforms.Normalize",
                            "mean": [
                                0.485,
                                0.456,
                                0.406
                            ],
                            "std": [
                                0.229,
                                0.224,
                                0.225
                            ]
                        }
                    ]
                }
            },
            {
                "old_key": "3dbox_images",
                "new_key": "3dbox_images_denorm",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                192,
                                384
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "3dbox_images",
                "new_key": "3dbox_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                216,
                                384
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        },
                        {
                            "_class_name": "torchvision.transforms.Normalize",
                            "mean": [
                                0.485,
                                0.456,
                                0.406
                            ],
                            "std": [
                                0.229,
                                0.224,
                                0.225
                            ]
                        }
                    ]
                }
            },
            {
                "old_key": "hdmap_images",
                "new_key": "hdmap_images_denorm",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                192,
                                384
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "hdmap_images",
                "new_key": "hdmap_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                216,
                                384
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        },
                        {
                            "_class_name": "torchvision.transforms.Normalize",
                            "mean": [
                                0.485,
                                0.456,
                                0.406
                            ],
                            "std": [
                                0.229,
                                0.224,
                                0.225
                            ]
                        }
                    ]
                }
            },
            {
                "old_key": "scene_description",
                "new_key": "clip_text",
                "transform": {
                    "_class_name": "dwm.datasets.common.Copy"
                }
            }
        ],
        "pop_list": [
            "images"
        ]
    },
    "validation_dataset": {
        "_class_name": "dwm.datasets.common.DatasetAdapter",
        "base_dataset": {
            "_class_name": "dwm.datasets.nuscenes.MotionDataset",
            "reader": {
                "_class_name": "dwm.common.ChainedReaders",
                "reader_list": [
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-trainval_meta.zip"
                        }
                    },
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-trainval01_blobs.zip"
                        }
                    },
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-trainval02_blobs.zip"
                        }
                    },
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-trainval03_blobs.zip"
                        }
                    },
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-trainval04_blobs.zip"
                        }
                    },
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-trainval05_blobs.zip"
                        }
                    },
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-trainval06_blobs.zip"
                        }
                    },
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-trainval07_blobs.zip"
                        }
                    },
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-trainval08_blobs.zip"
                        }
                    },
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-trainval09_blobs.zip"
                        }
                    },
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-trainval10_blobs.zip"
                        }
                    },
                    {
                        "_class_name": "dwm.common.StatelessZipFile",
                        "lazy_file": {
                            "_class_name": "dwm.common.LazyFile",
                            "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/nuScenes-map-expansion-v1.3.zip"
                        }
                    }
                ]
            },
            "dataset_name": "v1.0-trainval",
            "sequence_length": 1,
            "fps_stride_tuples": [
                [
                    0,
                    3
                ]
            ],
            "split": "val",
            "sensor_channels": [
                "LIDAR_TOP",
                "CAM_BACK_RIGHT",
                "CAM_BACK",
                "CAM_BACK_LEFT",
                "CAM_FRONT_LEFT",
                "CAM_FRONT",
                "CAM_FRONT_RIGHT"
            ],
            "_3dbox_bev_settings": {
                "bev_from_ego_transform":
                [
                    [6.4, 0, 0, 314],
                    [0, -6.4, 0, 320],
                    [0, 0, -6.4, 0],
                    [0, 0, 0, 1]
                ],
                "fill_box": true
            },
            "hdmap_bev_settings": {
                "bev_from_ego_transform":
                [
                    [6.4, 0, 0, 314],
                    [0, -6.4, 0, 320],
                    [0, 0, -6.4, 0],
                    [0, 0, 0, 1]
                ]
            },
            "keyframe_only": true,
            "enable_scene_description": true,
            "enable_camera_transforms": true,
            "_3dbox_image_settings": {},
            "hdmap_image_settings": {},
            "is_multimodal": true,
            "enable_ego_transforms": true,
            "can_bus_extension": {
                "_class_name": "dwm.datasets.nuscenes.CanBusExtension",
                "reader": {
                    "_class_name": "dwm.common.StatelessZipFile",
                    "lazy_file": {
                        "_class_name": "dwm.common.LazyFile",
                        "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes/v1.0-can_bus.zip"
                    }
                }
            }
        },
        "transform_list": [
            {
                "old_key": "images",
                "new_key": "vae_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                216,
                                384
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "images",
                "new_key": "bev_images_denorm",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                900,
                                1600
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "images",
                "new_key": "bev_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                216,
                                384
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        },
                        {
                            "_class_name": "torchvision.transforms.Normalize",
                            "mean": [
                                0,
                                0,
                                0
                            ],
                            "std": [
                                0.00392157,
                                0.00392157,
                                0.00392157
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.Normalize",
                            "mean": [
                                123.675,
                                116.280,
                                103.530
                            ],
                            "std": [
                                1.0,
                                1.0,
                                1.0
                            ]
                        }
                    ]
                }
            },
            {
                "old_key": "3dbox_bev_images",
                "new_key": "3dbox_bev_images_denorm",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                640,
                                640
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "3dbox_bev_images",
                "new_key": "3dbox_bev_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                640,
                                640
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        },
                        {
                            "_class_name": "torchvision.transforms.Normalize",
                            "mean": [
                                0.485,
                                0.456,
                                0.406
                            ],
                            "std": [
                                0.229,
                                0.224,
                                0.225
                            ]
                        }
                    ]
                }
            },
            {
                "old_key": "hdmap_bev_images",
                "new_key": "hdmap_bev_images_denorm",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                640,
                                640
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "hdmap_bev_images",
                "new_key": "hdmap_bev_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                640,
                                640
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        },
                        {
                            "_class_name": "torchvision.transforms.Normalize",
                            "mean": [
                                0.485,
                                0.456,
                                0.406
                            ],
                            "std": [
                                0.229,
                                0.224,
                                0.225
                            ]
                        }
                    ]
                }
            },
            {
                "old_key": "3dbox_images",
                "new_key": "3dbox_images_denorm",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                192,
                                384
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "3dbox_images",
                "new_key": "3dbox_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                216,
                                384
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        },
                        {
                            "_class_name": "torchvision.transforms.Normalize",
                            "mean": [
                                0.485,
                                0.456,
                                0.406
                            ],
                            "std": [
                                0.229,
                                0.224,
                                0.225
                            ]
                        }
                    ]
                }
            },
            {
                "old_key": "hdmap_images",
                "new_key": "hdmap_images_denorm",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                192,
                                384
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "hdmap_images",
                "new_key": "hdmap_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                216,
                                384
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        },
                        {
                            "_class_name": "torchvision.transforms.Normalize",
                            "mean": [
                                0.485,
                                0.456,
                                0.406
                            ],
                            "std": [
                                0.229,
                                0.224,
                                0.225
                            ]
                        }
                    ]
                }
            },
            {
                "old_key": "scene_description",
                "new_key": "clip_text",
                "transform": {
                    "_class_name": "dwm.datasets.common.Copy"
                }
            }
        ],
        "pop_list": [
            "images"
        ]
    },
    "training_dataloader": {
        "batch_size": 1,
        "num_workers": 1,
        "collate_fn": {
            "_class_name": "dwm.datasets.common.get_collate_fn_ignoring",
            "keys": [
                "lidar_points"
            ]
        }
    },
    "validation_dataloader": {
        "batch_size": 1,
        "num_workers": 2,
        "collate_fn": {
            "_class_name": "dwm.datasets.common.get_collate_fn_ignoring",
            "keys": [
                "lidar_points"
            ]
        }
    },
    "data_shuffle": true,
    "train_epochs": 160,
    "gradient_accumulation_steps": 1,
    "optimizer": {
        "_class_name": "torch.optim.AdamW",
        "lr": 8e-4
    },
    "lr_scheduler": {
        "_class_name": "torch.optim.lr_scheduler.CosineAnnealingLR",
        "eta_min": 8e-7,
        "T_max": 187533
    },
    "preview_image_size": [
        384,
        216
    ]
}