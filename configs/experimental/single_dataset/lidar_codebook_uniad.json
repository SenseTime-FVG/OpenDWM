{
    "device": "cuda",
    "ddp_backend": "nccl",
    "train_epochs": 2,
    "generator_seed": 0,
    "data_shuffle": true,
    "fix_training_data_order": true,
    "optimizer": {
        "_class_name": "torch.optim.AdamW",
        "lr": 5e-4,
        "betas": [
            0.9,
            0.995
        ],
        "weight_decay": 0.0001
    },
    "pipeline": {
        "_class_name": "dwm.pipelines.lidar_codebook.LidarCodebook",
        "common_config": {
            "ray_cast_center": [
                1.0,
                0.0,
                2.0
            ]
        },
        "training_config": {
            "loss_coef_dict": {
                "voxel_loss": 100.0,
                "emb_loss": 10.0,
                "depth_loss": 0.05,
                "sdf_loss": 0.05
            }
        },
        "inference_config": {
            "preview_image_size": [
                640,
                640
            ]
        },
        "vq_point_cloud": {
            "_class_name": "dwm.models.vq_point_cloud.VQPointCloud",
            "voxelizer": {
                "_class_name": "dwm.models.voxelizer.Voxelizer",
                "x_min": -50.0,
                "x_max": 50.0,
                "y_min": -50.0,
                "y_max": 50.0,
                "z_min": -3.0,
                "z_max": 5.0,
                "step": 0.15625,
                "z_step": 0.125
            },
            "vector_quantizer": {
                "_class_name": "dwm.models.vq_point_cloud.VectorQuantizer",
                "n_e": 2048,
                "e_dim": 1024,
                "beta": 0.25,
                "cosine_similarity": false
            },
            "lidar_encoder": {
                "_class_name": "dwm.models.vq_point_cloud.VQEncoder",
                "img_size": 640,
                "codebook_dim": 1024,
                "in_chans": 64,
                "embed_dim": 512,
                "num_heads": 8,
                "use_checkpoint": true
            },
            "lidar_decoder": {
                "_class_name": "dwm.models.vq_point_cloud.VQDecoder",
                "img_size": [
                    640,
                    640
                ],
                "num_patches": 6400,
                "in_chans": 64,
                "embed_dim": 512,
                "num_heads": 8,
                "codebook_dim": 1024,
                "bias_init": -5.0,
                "upsample_style": "pixel_shuffle",
                "use_checkpoint": true
            },
            "bias_init": -5.0
        }
    },
    "training_dataset": {
        "_class_name": "dwm.datasets.common.DatasetAdapter",
        "base_dataset": {
            "_class_name": "dwm.datasets.uniad.MotionDataset",
            "fs": {
                "_class_name": "dwm.fs.czip.CombinedZipFileSystem",
                "fs": {
                    "_class_name": "dwm.fs.dirfs.DirFileSystem",
                    "path": "/cache/aoss-v2.st-sh-01.sensecoreapi-oss.cn/users/wuzehuan",
                    "fs": {
                        "_class_name": "fsspec.implementations.local.LocalFileSystem"
                    }
                },
                "paths": [
                    "data/uniad/0530_json.zip",
                    "data/uniad/0530/blob_001.zip",
                    "data/uniad/0530/blob_002.zip",
                    "data/uniad/0530/blob_003.zip",
                    "data/uniad/0530/blob_004.zip",
                    "data/uniad/0530/blob_005.zip",
                    "data/uniad/0530/blob_006.zip",
                    "data/uniad/0530/blob_007.zip",
                    "data/uniad/0530/blob_008.zip",
                    "data/uniad/0530/blob_009.zip",
                    "data/uniad/0530/blob_010.zip",
                    "data/uniad/0530/blob_011.zip",
                    "data/uniad/0530/blob_012.zip",
                    "data/uniad/0530/blob_013.zip",
                    "data/uniad/0530/blob_014.zip",
                    "data/uniad/0530/blob_015.zip",
                    "data/uniad/0530/blob_016.zip",
                    "data/uniad/0530/blob_017.zip",
                    "data/uniad/0530/blob_018.zip",
                    "data/uniad/0530/blob_019.zip",
                    "data/uniad/0530/blob_020.zip",
                    "data/uniad/0530/blob_021.zip",
                    "data/uniad/0530/blob_022.zip",
                    "data/uniad/0530/blob_023.zip",
                    "data/uniad/0530/blob_024.zip",
                    "data/uniad/0530/blob_025.zip",
                    "data/uniad/0530/blob_026.zip",
                    "data/uniad/0530/blob_027.zip",
                    "data/uniad/0530/blob_028.zip",
                    "data/uniad/0530/blob_029.zip",
                    "data/uniad/0530/blob_030.zip",
                    "data/uniad/0530/blob_031.zip",
                    "data/uniad/0530/blob_032.zip",
                    "data/uniad/0530/blob_033.zip",
                    "data/uniad/0530/blob_034.zip",
                    "data/uniad/0530/blob_035.zip",
                    "data/uniad/0530/blob_036.zip",
                    "data/uniad/0530/blob_037.zip",
                    "data/uniad/0530/blob_038.zip",
                    "data/uniad/0530/blob_039.zip",
                    "data/uniad/0530/blob_040.zip",
                    "data/uniad/0530/blob_041.zip",
                    "data/uniad/0530/blob_042.zip",
                    "data/uniad/0530/blob_043.zip",
                    "data/uniad/0530/blob_044.zip",
                    "data/uniad/0530/blob_045.zip",
                    "data/uniad/0530/blob_046.zip",
                    "data/uniad/0530/blob_047.zip",
                    "data/uniad/0530/blob_048.zip",
                    "data/uniad/0530/blob_049.zip",
                    "data/uniad/0530/blob_050.zip",
                    "data/uniad/0530/blob_051.zip",
                    "data/uniad/0530/blob_053.zip",
                    "data/uniad/0530/blob_054.zip",
                    "data/uniad/0530/blob_055.zip",
                    "data/uniad/0530/blob_056.zip",
                    "data/uniad/0530/blob_057.zip",
                    "data/uniad/0530/blob_058.zip",
                    "data/uniad/0530/blob_059.zip",
                    "data/uniad/0530/blob_060.zip",
                    "data/uniad/0530/blob_061.zip",
                    "data/uniad/0530/blob_062.zip",
                    "data/uniad/0530/blob_063.zip",
                    "data/uniad/0530/blob_064.zip",
                    "data/uniad/0530/blob_065.zip",
                    "data/uniad/0530/blob_066.zip",
                    "data/uniad/0530/blob_067.zip",
                    "data/uniad/0530/blob_068.zip",
                    "data/uniad/0530/blob_069.zip",
                    "data/uniad/0530/blob_070.zip",
                    "data/uniad/0530/blob_071.zip",
                    "data/uniad/0530/blob_072.zip",
                    "data/uniad/0530/blob_073.zip",
                    "data/uniad/0530/blob_074.zip",
                    "data/uniad/0530/blob_075.zip",
                    "data/uniad/0530/blob_076.zip",
                    "data/uniad/0530/blob_077.zip",
                    "data/uniad/0530/blob_078.zip",
                    "data/uniad/0530/blob_079.zip",
                    "data/uniad/0530/blob_080.zip",
                    "data/uniad/0530/blob_081.zip",
                    "data/uniad/0530/blob_082.zip",
                    "data/uniad/0530/blob_083.zip",
                    "data/uniad/0530/blob_084.zip",
                    "data/uniad/0530/blob_085.zip",
                    "data/uniad/0530/blob_086.zip",
                    "data/uniad/0530/blob_087.zip",
                    "data/uniad/0530/blob_088.zip",
                    "data/uniad/0530/blob_089.zip",
                    "data/uniad/0530/blob_090.zip",
                    "data/uniad/0530/blob_091.zip",
                    "data/uniad/0530/blob_092.zip",
                    "data/uniad/0530/blob_093.zip",
                    "data/uniad/0530/blob_094.zip",
                    "data/uniad/0530/blob_095.zip",
                    "data/uniad/0530/blob_096.zip",
                    "data/uniad/0530/blob_097.zip",
                    "data/uniad/0530/blob_098.zip",
                    "data/uniad/0530/blob_099.zip",
                    "data/uniad/0530/blob_100.zip",
                    "data/uniad/0530/blob_101.zip",
                    "data/uniad/0530/blob_102.zip",
                    "data/uniad/0530/blob_103.zip",
                    "data/uniad/0530/blob_105.zip",
                    "data/uniad/0530/blob_106.zip",
                    "data/uniad/0530/blob_107.zip",
                    "data/uniad/0530/blob_108.zip",
                    "data/uniad/0530/blob_109.zip",
                    "data/uniad/0530/blob_110.zip",
                    "data/uniad/0530/blob_111.zip",
                    "data/uniad/0530/blob_112.zip",
                    "data/uniad/0530/blob_113.zip",
                    "data/uniad/0530/blob_114.zip",
                    "data/uniad/0530/blob_115.zip",
                    "data/uniad/0530/blob_116.zip",
                    "data/uniad/0530/blob_117.zip",
                    "data/uniad/0530/blob_118.zip",
                    "data/uniad/0530/blob_119.zip",
                    "data/uniad/0530/blob_120.zip",
                    "data/uniad/0530/blob_121.zip",
                    "data/uniad/0530/blob_122.zip",
                    "data/uniad/0530/blob_123.zip",
                    "data/uniad/0530/blob_124.zip",
                    "data/uniad/0530/blob_125.zip",
                    "data/uniad/0530/blob_126.zip",
                    "data/uniad/0530/blob_127.zip",
                    "data/uniad/0530/blob_128.zip",
                    "data/uniad/0530/blob_129.zip",
                    "data/uniad/0530/blob_130.zip"
                ],
                "enable_cached_info": true
            },
            "pkl_path_list": [
                "/mnt/storage/user/wuzehuan/Downloads/data/uniad/0530_train_2.pkl"
            ],
            "sequence_length": 1,
            "fps_stride_tuples": [
                [
                    0,
                    1
                ]
            ],
            "sensor_channels": [
                "lidar"
            ],
            "enable_camera_transforms": true
        },
        "transform_list": [
            {
                "old_key": "lidar_points",
                "new_key": "lidar_points",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "dwm.datasets.common.FilterPoints",
                            "min_distance": 2.4,
                            "max_distance": 72.0
                        },
                        {
                            "_class_name": "dwm.datasets.common.TakePoints",
                            "max_count": 32768
                        }
                    ]
                },
                "stack": false
            }
        ],
        "pop_list": []
    },
    "validation_dataset": {
        "_class_name": "dwm.datasets.common.DatasetAdapter",
        "base_dataset": {
            "_class_name": "dwm.datasets.uniad.MotionDataset",
            "fs": {
                "_class_name": "dwm.fs.czip.CombinedZipFileSystem",
                "fs": {
                    "_class_name": "dwm.fs.dirfs.DirFileSystem",
                    "path": "/cache/aoss-v2.st-sh-01.sensecoreapi-oss.cn/users/wuzehuan",
                    "fs": {
                        "_class_name": "fsspec.implementations.local.LocalFileSystem"
                    }
                },
                "paths": [
                    "data/uniad/0530_json.zip",
                    "data/uniad/0530/blob_000.zip",
                    "data/uniad/0530/blob_052.zip",
                    "data/uniad/0530/blob_104.zip"
                ],
                "enable_cached_info": true
            },
            "pkl_path_list": [
                "/mnt/storage/user/wuzehuan/Downloads/data/uniad/0530_val.pkl"
            ],
            "sequence_length": 1,
            "fps_stride_tuples": [
                [
                    0,
                    120
                ]
            ],
            "sensor_channels": [
                "lidar"
            ],
            "enable_camera_transforms": true
        },
        "transform_list": [
            {
                "old_key": "lidar_points",
                "new_key": "lidar_points",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "dwm.datasets.common.FilterPoints",
                            "min_distance": 2.4,
                            "max_distance": 72.0
                        },
                        {
                            "_class_name": "dwm.datasets.common.TakePoints",
                            "max_count": 32768
                        }
                    ]
                },
                "stack": false
            }
        ],
        "pop_list": []
    },
    "training_dataloader": {
        "batch_size": 6,
        "num_workers": 3,
        "prefetch_factor": 3,
        "collate_fn": {
            "_class_name": "dwm.datasets.common.CollateFnIgnoring",
            "keys": [
                "lidar_points"
            ]
        },
        "persistent_workers": true
    },
    "validation_dataloader": {
        "batch_size": 2,
        "num_workers": 1,
        "prefetch_factor": 3,
        "collate_fn": {
            "_class_name": "dwm.datasets.common.CollateFnIgnoring",
            "keys": [
                "lidar_points"
            ]
        },
        "persistent_workers": true
    },
    "preview_dataloader": {
        "batch_size": 2,
        "num_workers": 1,
        "prefetch_factor": 1,
        "shuffle": true,
        "drop_last": true,
        "collate_fn": {
            "_class_name": "dwm.datasets.common.CollateFnIgnoring",
            "keys": [
                "lidar_points"
            ]
        },
        "persistent_workers": true
    },
    "informations": {
        "voxel_rec_iou": 0.20,
        "lidar_rec_iou": 0.25,
        "total_batch_sizes": 96,
        "steps": 60000
    }
}