{
    "device": "cuda",
    "ddp_backend": "nccl",
    "train_epochs": 62,
    "generator_seed": 0,
    "data_shuffle": true,
    "optimizer": {
        "_class_name": "torch.optim.AdamW",
        "lr": 4e-5
    },
    "lr_scheduler": {
        "_class_name": "torch.optim.lr_scheduler.ExponentialLR",
        "gamma": 1.0
    },
    "pipeline": {
        "_class_name": "dwm.pipelines.holodrive.DWM",
        "common_config": {
            "dump_lss_gate_factors": false,
            "single_frame": true,
            "disable_crossview": false,
            "disable_temporal": true,
            "bev_specification": {
                "range": [
                    50,
                    50
                ],
                "shape": [
                    40,
                    40
                ]
            },
            "feature_collect_range": [
                1,
                3
            ],
            "point_count_limit_per_view": 6144,
            "point_bundle_size": 128,
            "use_bev_vq_feature": false,
            "use_reference_coordinate": true,
            "use_discrete_diffsuion": false,
            "cat_condition": true,
            "cond_with_layout": false,
            "cond_with_cxt": false,
            "cond_with_action": false,
            "distribution_framework": "fsdp",
            "autocast": {
                "device_type": "cuda"
            },
            "ddp_wrapper_settings": {
                "auto_wrap_policy": {
                    "_class_name": "torch.distributed.fsdp.wrap.ModuleWrapPolicy",
                    "module_classes": [
                        {
                            "_class_name": "get_class",
                            "class_name": "dwm.models.crossview_temporal.TransformerModel"
                        },
                        {
                            "_class_name": "get_class",
                            "class_name": "dwm.models.crossview_temporal.ResBlock"
                        }
                    ]
                },
                "mixed_precision": {
                    "_class_name": "torch.distributed.fsdp.MixedPrecision",
                    "param_dtype": {
                        "_class_name": "get_class",
                        "class_name": "torch.float16"
                    }
                },
                "use_orig_params": true
            },
            "joint_forward_policy": "separate",
            "fsdp_with_ignored_modules": true,
            "ctsd_act_type": "speed_steering",
            "use_action": false,
            "action_tying": false,
            "unet_input_type": null
        },
        "training_config": {
            "latent_sample_method": "sample",
            "train_feature_exchange": true,
            "text_prompt_condition_ratio": 0.8,
            "3dbox_condition_ratio": 0.8,
            "hdmap_condition_ratio": 0.8,
            "loss_coef_dict": {
                "d1": 0.1,
                "d2": 0.1
            },
            "ignore_list_of_non_init_step": [
                "sd1",
                "d1",
                "mg1"
            ],
            "enable_grad_scaler": true,
            "forward2_with_depth_loss": false
        },
        "inference_config": {
            "infer_feature_exchange": false,
            "guidance_scale": 3,
            "inference_steps": 50,
            "preview_image_size": [
                448,
                256
            ],
            "fid_evaluation_maximum_sample_count": 10000
        },
        "load_state_args": {
            "strict": false
        },
        "unet_load_state_args": {
            "strict": false
        },
        "vq_point_cloud": {
            "_class_name": "dwm.models.vq_point_cloud.VQPointCloud",
            "voxelizer": {
                "_class_name": "dwm.models.voxelizer.Voxelizer",
                "x_min": -50.0,
                "x_max": 50.0,
                "y_min": -50.0,
                "y_max": 50.0,
                "z_min": -5.0,
                "z_max": 3.0,
                "step": 0.15625,
                "z_step": 0.125
            },
            "vector_quantizer": {
                "_class_name": "dwm.models.vq_point_cloud.VectorQuantizer",
                "n_e": 2048,
                "e_dim": 1024,
                "beta": 0.25,
                "cosine_similarity": false
            },
            "lidar_encoder": {
                "_class_name": "dwm.models.vq_point_cloud.VQEncoder",
                "img_size": 640,
                "codebook_dim": 1024,
                "in_chans": 64,
                "embed_dim": 512,
                "num_heads": 8
            },
            "lidar_decoder": {
                "_class_name": "dwm.models.vq_point_cloud.VQDecoder",
                "img_size": [
                    640,
                    640
                ],
                "num_patches": 6400,
                "codebook_dim": 1024,
                "bias_init": -5,
                "in_chans": 64,
                "embed_dim": 512,
                "num_heads": 8
            }
        },
        "wm": {
            "_class_name": "dwm.models.joint_general.BlockWiseHoloDrive",
            "ctsd": {
                "_class_name": "dwm.models.crossview_temporal_unet.UNetCrossviewTemporalConditionModel",
                "addition_time_embed_dim": 256,
                "block_out_channels": [
                    320,
                    640,
                    1280,
                    1280
                ],
                "cross_attention_dim": 1024,
                "down_block_types": [
                    "CrossAttnDownBlockCrossviewTemporal",
                    "CrossAttnDownBlockCrossviewTemporal",
                    "CrossAttnDownBlockCrossviewTemporal",
                    "DownBlockCrossviewTemporal"
                ],
                "in_channels": 4,
                "layers_per_block": 2,
                "num_attention_heads": [
                    5,
                    10,
                    20,
                    20
                ],
                "out_channels": 4,
                "projection_class_embeddings_input_dim": null,
                "sample_size": 96,
                "transformer_layers_per_block": 1,
                "up_block_types": [
                    "UpBlockCrossviewTemporal",
                    "CrossAttnUpBlockCrossviewTemporal",
                    "CrossAttnUpBlockCrossviewTemporal",
                    "CrossAttnUpBlockCrossviewTemporal"
                ],
                "merge_factor": 5,
                "enable_crossview": true,
                "enable_temporal": false,
                "enable_rowwise_crossview": true,
                "depth_net_config": {
                    "in_channels": 3840,
                    "camera_parameter_channels": 25,
                    "mid_channels": 512,
                    "context_channels": 80,
                    "depth_channels": 96,
                    "momentum": 0.25,
                    "gradient_checkpointing": true,
                    "bn_in_reduce_conv": false
                },
                "depth_frustum_range": [
                    1,
                    58.6,
                    0.6
                ],
                "condition_image_adapter_config": {
                    "in_channels": 6,
                    "channels": [
                        320,
                        320,
                        640,
                        1280,
                        1280
                    ],
                    "is_downblocks": [
                        false,
                        true,
                        true,
                        true,
                        false
                    ],
                    "num_res_blocks": 3,
                    "downscale_factor": 8,
                    "use_zero_convs": true
                }
            },
            "maskgit": {
                "_class_name": "dwm.models.lidar.UnetTransformerAlignV2",
                "n_e": 2048,
                "e_dim": 1024,
                "img_size": [
                    80,
                    40
                ],
                "block_out_channels": [
                    256,
                    384,
                    512
                ],
                "mid_block_channels": 512,
                "num_down_block": [
                    2,
                    2
                ],
                "num_up_block": [
                    1,
                    2
                ],
                "num_heads": 16,
                "sequence_length": 1,
                "window_size": 4,
                "cross_attend": false,
                "use_checkpoint": true,
                "use_action": false,
                "enable_temporal": false,
                "act_type": "copliot4D_v2",
                "dtype_t": "gpt2",
                "initializer_type": "cop4d",
                "cond_inject": "Merge",
                "cond_in_channels": 512,
                "cond_is_downblocks": [
                    false,
                    true,
                    true
                ],
                "cond_num_res_blocks": 2,
                "cond_downscale_factor": 1
            },
            "ia_modules": {
                "lss0": [{
                    "_class_name": "dwm.utils.mm_utils.LSSBased2DTO3D",
                    "embed_dim": 320, "out_dim": 384, "num_depth_adapter": 1
                }],
                "gsample0": [{
                    "_class_name": "dwm.utils.mm_utils.LSSBased3DTO2D",
                    "embed_dim": 384, "out_dim": 320, "num_depth_adapter": 1
                }]
            },
            "bevformer_id": null,
            "forward_depth_recipe": [
                "2d_d_0_none_none",
                "2d_d_1_none_none",
                "2d_d_2_none_none",
                "2d_d_3_none_none",
                "2d_depth_none_none_none"
            ],
            "forward_2d_3d_recipe": [
                "3d_pre_none_none_none",
                "3d_d_0_none_none",
                "2d_d_0_gsample0_d-0",
                "3d_none_none_lss0_d-0",
                "2d_d_1_none_none",
                "3d_d_1_none_none",
                "2d_d_2_none_none",
                "2d_d_3_none_none",
                "2d_mid_none_none_none",
                "3d_mid_none_none_none",
                "2d_u_0_none_none",
                "2d_u_1_none_none",
                "2d_u_2_none_none",
                "2d_u_3_none_none",
                "3d_u_0_none_none",
                "3d_u_1_none_none"
            ]
        },
        "pretrained_model_name_or_path": "/mnt/storage/user/wuzehuan/Downloads/models/stable-diffusion-2-1",
        "wm_ckpt_path": null,
        "ctsd_ckpt_path": "/mnt/storage/user/wuzehuan/Downloads/models/stable-diffusion-2-1/unet/diffusion_pytorch_model.fp16.safetensors",
        "maskgit_ckpt_path": null,
        "bevformer_ckpt_path": null,
        "vq_point_cloud_ckpt_path": "/mnt/storage/user/wuzehuan/Documents/WorldModels/Models/dwm-lidar/codebook_epoch_100.pth",
        "vq_blank_code_path": "/mnt/storage/user/wangxiaodong/DWM_work_dir/blank_code_eval/blank_code.pkl"
    },
    "training_dataset": {
        "_class_name": "dwm.datasets.common.DatasetAdapter",
        "base_dataset": {
            "_class_name": "dwm.datasets.nuscenes.MotionDataset",
            "fs": {
                "_class_name": "dwm.fs.czip.CombinedZipFileSystem",
                "fs": {
                    "_class_name": "fsspec.implementations.dirfs.DirFileSystem",
                    "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes",
                    "fs": {
                        "_class_name": "fsspec.implementations.local.LocalFileSystem"
                    }
                },
                "paths": [
                    "v1.0-trainval_meta.zip",
                    "v1.0-trainval01_blobs.zip",
                    "v1.0-trainval02_blobs.zip",
                    "v1.0-trainval03_blobs.zip",
                    "v1.0-trainval04_blobs.zip",
                    "v1.0-trainval05_blobs.zip",
                    "v1.0-trainval06_blobs.zip",
                    "v1.0-trainval07_blobs.zip",
                    "v1.0-trainval08_blobs.zip",
                    "v1.0-trainval09_blobs.zip",
                    "v1.0-trainval10_blobs.zip",
                    "nuScenes-map-expansion-v1.3.zip",
                    "v1.0-can_bus.zip"
                ],
                "enable_cached_info": true
            },
            "dataset_name": "v1.0-trainval",
            "split": "train",
            "sequence_length": 1,
            "fps_stride_tuples": [
                [
                    0,
                    1
                ]
            ],
            "sensor_channels": [
                "CAM_FRONT_LEFT",
                "CAM_FRONT",
                "CAM_FRONT_RIGHT",
                "CAM_BACK_RIGHT",
                "CAM_BACK",
                "CAM_BACK_LEFT",
                "LIDAR_TOP"
            ],
            "keyframe_only": true,
            "is_multimodal": true,
            "enable_scene_description": true,
            "enable_camera_transforms": true,
            "enable_ego_transforms": true,
            "can_bus_table_names": ["steeranglefeedback", "vehicle_monitor", "pose"],
            "_3dbox_image_settings": {
                "color_table": {
                    "vehicle.car": [
                        0,
                        0,
                        255
                    ],
                    "vehicle.bus": [
                        128,
                        0,
                        255
                    ],
                    "vehicle.truck": [
                        255,
                        255,
                        0
                    ],
                    "vehicle.construction": [
                        128,
                        128,
                        255
                    ],
                    "vehicle.emergency": [
                        255,
                        128,
                        128
                    ],
                    "vehicle.trailer": [
                        255,
                        255,
                        255
                    ],
                    "vehicle.bicycle": [
                        128,
                        255,
                        0
                    ],
                    "vehicle.motorcycle": [
                        0,
                        255,
                        128
                    ],
                    "human.pedestrian": [
                        255,
                        0,
                        0
                    ],
                    "movable_object.barrier": [
                        64,
                        64,
                        64
                    ],
                    "movable_object.trafficcone": [
                        128,
                        128,
                        0
                    ]
                },
                "pen_width": 8
            },
            "hdmap_image_settings": {},
            "_3dbox_bev_settings": {
                "bev_from_ego_transform": [
                    [
                        6.4,
                        0,
                        0,
                        314
                    ],
                    [
                        0,
                        -6.4,
                        0,
                        320
                    ],
                    [
                        0,
                        0,
                        -6.4,
                        0
                    ],
                    [
                        0,
                        0,
                        0,
                        1
                    ]
                ],
                "fill_box": true
            },
            "hdmap_bev_settings": {
                "bev_from_ego_transform": [
                    [
                        6.4,
                        0,
                        0,
                        314
                    ],
                    [
                        0,
                        -6.4,
                        0,
                        320
                    ],
                    [
                        0,
                        0,
                        -6.4,
                        0
                    ],
                    [
                        0,
                        0,
                        0,
                        1
                    ]
                ]
            }
        },
        "transform_list": [
            {
                "old_key": "images",
                "new_key": "vae_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                256,
                                448
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ColorJitter",
                            "brightness": 0.01,
                            "contrast": 0.02,
                            "saturation": 0.02
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "images",
                "new_key": "bev_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                256,
                                448
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        },
                        {
                            "_class_name": "torchvision.transforms.Normalize",
                            "mean": [
                                0,
                                0,
                                0
                            ],
                            "std": [
                                0.00392157,
                                0.00392157,
                                0.00392157
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.Normalize",
                            "mean": [
                                123.675,
                                116.280,
                                103.530
                            ],
                            "std": [
                                1.0,
                                1.0,
                                1.0
                            ]
                        }
                    ]
                }
            },
            {
                "old_key": "3dbox_images",
                "new_key": "3dbox_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                256,
                                448
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "hdmap_images",
                "new_key": "hdmap_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                256,
                                448
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "3dbox_bev_images",
                "new_key": "3dbox_bev_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                640,
                                640
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        },
                        {
                            "_class_name": "torchvision.transforms.Normalize",
                            "mean": [
                                0.485,
                                0.456,
                                0.406
                            ],
                            "std": [
                                0.229,
                                0.224,
                                0.225
                            ]
                        }
                    ]
                }
            },
            {
                "old_key": "hdmap_bev_images",
                "new_key": "hdmap_bev_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                640,
                                640
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        },
                        {
                            "_class_name": "torchvision.transforms.Normalize",
                            "mean": [
                                0.485,
                                0.456,
                                0.406
                            ],
                            "std": [
                                0.229,
                                0.224,
                                0.225
                            ]
                        }
                    ]
                }
            },
            {
                "old_key": "lidar_points",
                "new_key": "lidar_points",
                "transform": {
                    "_class_name": "dwm.datasets.nuscenes.FilterPoints",
                    "min_distance": 2.4,
                    "max_distance": 72.0
                },
                "stack": false
            },
            {
                "old_key": "scene_description",
                "new_key": "clip_text",
                "transform": {
                    "_class_name": "dwm.datasets.common.Copy"
                }
            }
        ],
        "pop_list": [
            "images",
            "scene_description",
            "3dbox_bev_images",
            "hdmap_bev_images"
        ]
    },
    "validation_dataset": {
        "_class_name": "dwm.datasets.common.DatasetAdapter",
        "base_dataset": {
            "_class_name": "dwm.datasets.nuscenes.MotionDataset",
            "fs": {
                "_class_name": "dwm.fs.czip.CombinedZipFileSystem",
                "fs": {
                    "_class_name": "fsspec.implementations.dirfs.DirFileSystem",
                    "path": "/mnt/storage/user/wuzehuan/Downloads/data/nuscenes",
                    "fs": {
                        "_class_name": "fsspec.implementations.local.LocalFileSystem"
                    }
                },
                "paths": [
                    "v1.0-trainval_meta.zip",
                    "v1.0-trainval01_blobs.zip",
                    "v1.0-trainval02_blobs.zip",
                    "v1.0-trainval03_blobs.zip",
                    "v1.0-trainval04_blobs.zip",
                    "v1.0-trainval05_blobs.zip",
                    "v1.0-trainval06_blobs.zip",
                    "v1.0-trainval07_blobs.zip",
                    "v1.0-trainval08_blobs.zip",
                    "v1.0-trainval09_blobs.zip",
                    "v1.0-trainval10_blobs.zip",
                    "nuScenes-map-expansion-v1.3.zip",
                    "v1.0-can_bus.zip"
                ],
                "enable_cached_info": true
            },
            "dataset_name": "v1.0-trainval",
            "split": "val",
            "sequence_length": 1,
            "fps_stride_tuples": [
                [
                    0,
                    3
                ]
            ],
            "sensor_channels": [
                "CAM_FRONT_LEFT",
                "CAM_FRONT",
                "CAM_FRONT_RIGHT",
                "CAM_BACK_RIGHT",
                "CAM_BACK",
                "CAM_BACK_LEFT",
                "LIDAR_TOP"
            ],
            "keyframe_only": true,
            "is_multimodal": true,
            "enable_scene_description": true,
            "enable_camera_transforms": true,
            "enable_ego_transforms": true,
            "can_bus_table_names": ["steeranglefeedback", "vehicle_monitor", "pose"],
            "_3dbox_image_settings": {
                "color_table": {
                    "vehicle.car": [
                        0,
                        0,
                        255
                    ],
                    "vehicle.bus": [
                        128,
                        0,
                        255
                    ],
                    "vehicle.truck": [
                        255,
                        255,
                        0
                    ],
                    "vehicle.construction": [
                        128,
                        128,
                        255
                    ],
                    "vehicle.emergency": [
                        255,
                        128,
                        128
                    ],
                    "vehicle.trailer": [
                        255,
                        255,
                        255
                    ],
                    "vehicle.bicycle": [
                        128,
                        255,
                        0
                    ],
                    "vehicle.motorcycle": [
                        0,
                        255,
                        128
                    ],
                    "human.pedestrian": [
                        255,
                        0,
                        0
                    ],
                    "movable_object.barrier": [
                        64,
                        64,
                        64
                    ],
                    "movable_object.trafficcone": [
                        128,
                        128,
                        0
                    ]
                },
                "pen_width": 8
            },
            "hdmap_image_settings": {},
            "_3dbox_bev_settings": {
                "bev_from_ego_transform": [
                    [
                        6.4,
                        0,
                        0,
                        314
                    ],
                    [
                        0,
                        -6.4,
                        0,
                        320
                    ],
                    [
                        0,
                        0,
                        -6.4,
                        0
                    ],
                    [
                        0,
                        0,
                        0,
                        1
                    ]
                ],
                "fill_box": true
            },
            "hdmap_bev_settings": {
                "bev_from_ego_transform": [
                    [
                        6.4,
                        0,
                        0,
                        314
                    ],
                    [
                        0,
                        -6.4,
                        0,
                        320
                    ],
                    [
                        0,
                        0,
                        -6.4,
                        0
                    ],
                    [
                        0,
                        0,
                        0,
                        1
                    ]
                ]
            }
        },
        "transform_list": [
            {
                "old_key": "images",
                "new_key": "vae_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                256,
                                448
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "images",
                "new_key": "bev_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                256,
                                448
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        },
                        {
                            "_class_name": "torchvision.transforms.Normalize",
                            "mean": [
                                0,
                                0,
                                0
                            ],
                            "std": [
                                0.00392157,
                                0.00392157,
                                0.00392157
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.Normalize",
                            "mean": [
                                123.675,
                                116.280,
                                103.530
                            ],
                            "std": [
                                1.0,
                                1.0,
                                1.0
                            ]
                        }
                    ]
                }
            },
            {
                "old_key": "3dbox_images",
                "new_key": "3dbox_images_denorm",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                256,
                                448
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "3dbox_images",
                "new_key": "3dbox_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                256,
                                448
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "hdmap_images",
                "new_key": "hdmap_images_denorm",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                256,
                                448
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "hdmap_images",
                "new_key": "hdmap_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                256,
                                448
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "3dbox_bev_images",
                "new_key": "3dbox_bev_images_denorm",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                640,
                                640
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "3dbox_bev_images",
                "new_key": "3dbox_bev_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                640,
                                640
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        },
                        {
                            "_class_name": "torchvision.transforms.Normalize",
                            "mean": [
                                0.485,
                                0.456,
                                0.406
                            ],
                            "std": [
                                0.229,
                                0.224,
                                0.225
                            ]
                        }
                    ]
                }
            },
            {
                "old_key": "hdmap_bev_images",
                "new_key": "hdmap_bev_images_denorm",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                640,
                                640
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        }
                    ]
                }
            },
            {
                "old_key": "hdmap_bev_images",
                "new_key": "hdmap_bev_images",
                "transform": {
                    "_class_name": "torchvision.transforms.Compose",
                    "transforms": [
                        {
                            "_class_name": "torchvision.transforms.Resize",
                            "size": [
                                640,
                                640
                            ]
                        },
                        {
                            "_class_name": "torchvision.transforms.ToTensor"
                        },
                        {
                            "_class_name": "torchvision.transforms.Normalize",
                            "mean": [
                                0.485,
                                0.456,
                                0.406
                            ],
                            "std": [
                                0.229,
                                0.224,
                                0.225
                            ]
                        }
                    ]
                }
            },
            {
                "old_key": "lidar_points",
                "new_key": "lidar_points",
                "transform": {
                    "_class_name": "dwm.datasets.nuscenes.FilterPoints",
                    "min_distance": 2.4,
                    "max_distance": 72.0
                },
                "stack": false
            },
            {
                "old_key": "scene_description",
                "new_key": "clip_text",
                "transform": {
                    "_class_name": "dwm.datasets.common.Copy"
                }
            }
        ],
        "pop_list": [
            "images",
            "scene_description",
            "3dbox_bev_images",
            "hdmap_bev_images"
        ]
    },
    "training_dataloader": {
        "batch_size": 2,
        "num_workers": 5,
        "collate_fn": {
            "_class_name": "dwm.datasets.common.CollateFnIgnoring",
            "keys": [
                "lidar_points"
            ]
        }
    },
    "validation_dataloader": {
        "batch_size": 1,
        "num_workers": 2,
        "prefetch_factor": 3,
        "collate_fn": {
            "_class_name": "dwm.datasets.common.CollateFnIgnoring",
            "keys": [
                "lidar_points"
            ]
        }
    },
    "preview_dataloader": {
        "batch_size": 1,
        "num_workers": 1,
        "shuffle": true,
        "drop_last": true,
        "collate_fn": {
            "_class_name": "dwm.datasets.common.CollateFnIgnoring",
            "keys": [
                "lidar_points"
            ]
        }
    },
    "informations": {
        "fid": -1,
        "rmse": -1,
        "mean_ap": -1,
        "total_batch_sizes": 64,
        "steps": 27000
    }
}